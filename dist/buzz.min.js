 // ----------------------------------------------------------------------------
 // Buzz, a Javascript HTML5 Audio library
 // v1.1.0 - released 2013-09-22 14:25
 // Licensed under the MIT license.
 // http://buzz.jaysalvat.com/
 // ----------------------------------------------------------------------------
 // Copyright (C) 2010-2013 Jay Salvat
 // http://jaysalvat.com/
 // ----------------------------------------------------------------------------

!function(a,b,c){"undefined"!=typeof module&&module.exports?module.exports=c():"function"==typeof b.define&&b.define.amd?define(a,[],c):b[a]=c()}("buzz",this,function(){var a={defaults:{autoplay:!1,duration:5e3,formats:[],loop:!1,placeholder:"--",preload:"metadata",volume:80,document:document},types:{mp3:"audio/mpeg",ogg:"audio/ogg",wav:"audio/wav",aac:"audio/aac",m4a:"audio/x-m4a"},sounds:[],el:document.createElement("audio"),sound:function(b,c){function d(a){for(var b=[],c=a.length-1,d=0;c>=d;d++)b.push({start:a.start(d),end:a.end(d)});return b}function e(a){return a.split(".").pop()}function f(b,c){var d=j.createElement("source");d.src=c,a.types[e(c)]&&(d.type=a.types[e(c)]),b.appendChild(d)}function g(){if(!p.isPool)return!1;for(var a=h(null,arguments),b=a.shift(),c=0;c<o.length;c++)o[c][b].apply(o[c],a);return!0}function h(a,b){return a instanceof Array?a:Array.prototype.slice.call(b)}function i(a){if(void 0!==a)return o[a];for(var b=0;b<o.length;b++)if(o[b].isEnded()||o[b].isPaused())return o[b];return!1}c=c||{};var j=c.document||a.defaults.document,k=0,l=[],m={},n=a.isSupported(),o=[],p=this;if(this.load=function(){return!n||g("load")?this:(this.sound.load(),this)},this.play=function(){if(!n)return this;if(this.isPool){var a=i();if(!a)return;this.sound=a.sound}return this.sound.play(),this},this.togglePlay=function(){return!n||g("togglePlay")?this:(this.sound.paused?this.sound.play():this.sound.pause(),this)},this.pause=function(){return!n||g("pause")?this:(this.sound.pause(),this)},this.isPaused=function(){return n?this.sound.paused:null},this.stop=function(){return!n||g("stop")?this:(this.setTime(0),this.sound.pause(),this)},this.isEnded=function(){return n?this.sound.ended:null},this.loop=function(){return!n||g("loop")?this:(this.sound.loop="loop",this.bind("ended.buzzloop",function(){this.currentTime=0,this.play()}),this)},this.unloop=function(){return!n||g("unloop")?this:(this.sound.removeAttribute("loop"),this.unbind("ended.buzzloop"),this)},this.mute=function(){return!n||g("mute")?this:(this.sound.muted=!0,this)},this.unmute=function(){return!n||g("unmute")?this:(this.sound.muted=!1,this)},this.toggleMute=function(){return!n||g("toggleMute")?this:(this.sound.muted=!this.sound.muted,this)},this.isMuted=function(){return n?this.sound.muted:null},this.setVolume=function(a){return!n||g("setVolume",a)?this:(0>a&&(a=0),a>100&&(a=100),this.volume=a,this.sound.volume=a/100,this)},this.getVolume=function(){return n?this.volume:this},this.increaseVolume=function(a){return this.setVolume(this.volume+(a||1))},this.decreaseVolume=function(a){return this.setVolume(this.volume-(a||1))},this.setTime=function(a){if(!n||g("setTime",a))return this;var b=!0;return this.whenReady(function(){b===!0&&(b=!1,this.sound.currentTime=a)}),this},this.getTime=function(b){if(!n)return null;var c;if(void 0!==b&&this.isPool){var d=i(b);if(d&&d.sound)return c=Math.round(100*d.sound.currentTime)/100,isNaN(c)?a.defaults.placeholder:c}return c=Math.round(100*this.sound.currentTime)/100,isNaN(c)?a.defaults.placeholder:c},this.setPercent=function(b){return n?this.setTime(a.fromPercent(b,this.sound.duration)):this},this.getPercent=function(){if(!n)return null;var b=Math.round(a.toPercent(this.sound.currentTime,this.sound.duration));return isNaN(b)?a.defaults.placeholder:b},this.setSpeed=function(a){return n?(this.sound.playbackRate=a,this):this},this.getSpeed=function(){return n?this.sound.playbackRate:null},this.getDuration=function(){if(!n)return null;var b=Math.round(100*this.sound.duration)/100;return isNaN(b)?a.defaults.placeholder:b},this.getPlayed=function(){return n?d(this.sound.played):null},this.getBuffered=function(){return n?d(this.sound.buffered):null},this.getSeekable=function(){return n?d(this.sound.seekable):null},this.getErrorCode=function(){return n&&this.sound.error?this.sound.error.code:0},this.getErrorMessage=function(){if(!n)return null;switch(this.getErrorCode()){case 1:return"MEDIA_ERR_ABORTED";case 2:return"MEDIA_ERR_NETWORK";case 3:return"MEDIA_ERR_DECODE";case 4:return"MEDIA_ERR_SRC_NOT_SUPPORTED";default:return null}},this.getStateCode=function(){return n?this.sound.readyState:null},this.getStateMessage=function(){if(!n)return null;switch(this.getStateCode()){case 0:return"HAVE_NOTHING";case 1:return"HAVE_METADATA";case 2:return"HAVE_CURRENT_DATA";case 3:return"HAVE_FUTURE_DATA";case 4:return"HAVE_ENOUGH_DATA";default:return null}},this.getNetworkStateCode=function(){return n?this.sound.networkState:null},this.getNetworkStateMessage=function(){if(!n)return null;switch(this.getNetworkStateCode()){case 0:return"NETWORK_EMPTY";case 1:return"NETWORK_IDLE";case 2:return"NETWORK_LOADING";case 3:return"NETWORK_NO_SOURCE";default:return null}},this.set=function(a,b){return!n||g("set",a,b)?this:(this.sound[a]=b,this)},this.get=function(a){return n?a?this.sound[a]:this.sound:null},this.bind=function(a,b){if(!n||g("bind",a,b))return this;a=a.split(" ");for(var c=this,d=function(a){b.call(c,a)},e=0;e<a.length;e++){var f=a[e],h=f;f=h.split(".")[0],l.push({idx:h,func:d}),this.sound.addEventListener(f,d,!0)}return this},this.unbind=function(a){if(!n||g("unbind",a))return this;a=a.split(" ");for(var b=0;b<a.length;b++)for(var c=a[b],d=c.split(".")[0],e=0;e<l.length;e++){var f=l[e].idx.split(".");(l[e].idx==c||f[1]&&f[1]==c.replace(".",""))&&(this.sound.removeEventListener(d,l[e].func,!0),l.splice(e,1))}return this},this.bindOnce=function(a,b){if(!n||g("bindOnce",a,b))return this;var c=this;return m[k++]=!1,this.bind(a+"."+k,function(){m[k]||(m[k]=!0,b.call(c)),c.unbind(a+"."+k)}),this},this.trigger=function(a){if(!n||g("trigger",a))return this;a=a.split(" ");for(var b=0;b<a.length;b++)for(var c=a[b],d=0;d<l.length;d++){var e=l[d].idx.split(".");if(l[d].idx==c||e[0]&&e[0]==c.replace(".","")){var f=j.createEvent("HTMLEvents");f.initEvent(e[0],!1,!0),this.sound.dispatchEvent(f)}}return this},this.fadeTo=function(b,c,d){function e(){setTimeout(function(){b>f&&h.volume<b?(h.setVolume(h.volume+=1),e()):f>b&&h.volume>b?(h.setVolume(h.volume-=1),e()):d instanceof Function&&d.apply(h)},g)}if(!n)return this;c instanceof Function?(d=c,c=a.defaults.duration):c=c||a.defaults.duration;var f=this.volume,g=c/Math.abs(f-b),h=this;return this.play(),this.whenReady(function(){e()}),this},this.fadeIn=function(a,b){return!n||g("fadeIn",a,b)?this:this.setVolume(0).fadeTo(100,a,b)},this.fadeOut=function(a,b){return!n||g("fadeOut",a,b)?this:this.fadeTo(0,a,b)},this.fadeWith=function(a,b){return n?(this.fadeOut(b,function(){this.stop()}),a.play().fadeIn(b),this):this},this.whenReady=function(a){if(!n)return null;var b=this;0===this.sound.readyState?this.bind("canplay.buzzwhenready",function(){a.call(b)}):a.call(b)},n&&b){var q;for(q in a.defaults)a.defaults.hasOwnProperty(q)&&(c[q]=c[q]||a.defaults[q]);if(c.channels>1){this.isPool=!0;var r=c.channels;for(q=0;r>q;q++)c.channels=0,o.push(new a.sound(b,c));return this.sound=o[0].sound,void 0}if(this.sound=j.createElement("audio"),b instanceof Array)for(var s in b)b.hasOwnProperty(s)&&f(this.sound,b[s]);else if(c.formats.length)for(var t in c.formats)c.formats.hasOwnProperty(t)&&f(this.sound,b+"."+c.formats[t]);else f(this.sound,b);c.loop&&this.loop(),c.autoplay&&(this.sound.autoplay="autoplay"),this.sound.preload=c.preload===!0?"auto":c.preload===!1?"none":c.preload,this.setVolume(c.volume),a.sounds.push(this)}},group:function(a){function b(){for(var b=c(null,arguments),d=b.shift(),e=0;e<a.length;e++)a[e][d].apply(a[e],b)}function c(a,b){return a instanceof Array?a:Array.prototype.slice.call(b)}a=c(a,arguments),this.getSounds=function(){return a},this.add=function(b){b=c(b,arguments);for(var d=0;d<b.length;d++)a.push(b[d])},this.remove=function(b){b=c(b,arguments);for(var d=0;d<b.length;d++)for(var e=0;e<a.length;e++)if(a[e]==b[d]){a.splice(e,1);break}},this.load=function(){return b("load"),this},this.play=function(){return b("play"),this},this.togglePlay=function(){return b("togglePlay"),this},this.pause=function(a){return b("pause",a),this},this.stop=function(){return b("stop"),this},this.mute=function(){return b("mute"),this},this.unmute=function(){return b("unmute"),this},this.toggleMute=function(){return b("toggleMute"),this},this.setVolume=function(a){return b("setVolume",a),this},this.increaseVolume=function(a){return b("increaseVolume",a),this},this.decreaseVolume=function(a){return b("decreaseVolume",a),this},this.loop=function(){return b("loop"),this},this.unloop=function(){return b("unloop"),this},this.setTime=function(a){return b("setTime",a),this},this.set=function(a,c){return b("set",a,c),this},this.bind=function(a,c){return b("bind",a,c),this},this.unbind=function(a){return b("unbind",a),this},this.bindOnce=function(a,c){return b("bindOnce",a,c),this},this.trigger=function(a){return b("trigger",a),this},this.fade=function(a,c,d,e){return b("fade",a,c,d,e),this},this.fadeIn=function(a,c){return b("fadeIn",a,c),this},this.fadeOut=function(a,c){return b("fadeOut",a,c),this}},all:function(){return new a.group(a.sounds)},isSupported:function(){return!!a.el.canPlayType},isOGGSupported:function(){return!!a.el.canPlayType&&a.el.canPlayType('audio/ogg; codecs="vorbis"')},isWAVSupported:function(){return!!a.el.canPlayType&&a.el.canPlayType('audio/wav; codecs="1"')},isMP3Supported:function(){return!!a.el.canPlayType&&a.el.canPlayType("audio/mpeg;")},isAACSupported:function(){return!!a.el.canPlayType&&(a.el.canPlayType("audio/x-m4a;")||a.el.canPlayType("audio/aac;"))},toTimer:function(a,b){var c,d,e;return c=Math.floor(a/3600),c=isNaN(c)?"--":c>=10?c:"0"+c,d=b?Math.floor(a/60%60):Math.floor(a/60),d=isNaN(d)?"--":d>=10?d:"0"+d,e=Math.floor(a%60),e=isNaN(e)?"--":e>=10?e:"0"+e,b?c+":"+d+":"+e:d+":"+e},fromTimer:function(a){var b=a.toString().split(":");return b&&3==b.length&&(a=3600*parseInt(b[0],10)+60*parseInt(b[1],10)+parseInt(b[2],10)),b&&2==b.length&&(a=60*parseInt(b[0],10)+parseInt(b[1],10)),a},toPercent:function(a,b,c){var d=Math.pow(10,c||0);return Math.round(100*a/b*d)/d},fromPercent:function(a,b,c){var d=Math.pow(10,c||0);return Math.round(b/100*a*d)/d}};return a});